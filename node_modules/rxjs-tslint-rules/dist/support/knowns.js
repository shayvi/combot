"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var fs = require("fs");
var path = require("path");
var resolve = require("resolve");
var semver = require("semver");
function read(dir) {
    var entry;
    try {
        entry = resolve.sync("rxjs");
    }
    catch (error) {
        console.warn("Cannot find rxjs in node_modules; some rxjs-tslint-rules will be ineffectual.");
        return {};
    }
    var dist = path.dirname(entry);
    var root = dist.replace(/node_modules[\/\\]rxjs[\/\\](.*)$/, function (match) { return match; });
    var version = require(path.join(root, "package.json")).version;
    var ignored = semver.satisfies(version, "<5.5.0-beta.5") ? {} : { "toPromise": true };
    var names = fs.readdirSync(path.join(dist, dir));
    return names
        .filter(function (name) { return /^[a-z]\w+\.js$/.test(name); })
        .map(function (name) { return name.replace(/\.js/, ""); })
        .filter(function (name) { return !ignored[name]; })
        .reduce(function (acc, name) {
        return (tslib_1.__assign({}, acc, (_a = {}, _a[name] = true, _a)));
        var _a;
    }, {});
}
exports.knownObservables = read("add/observable");
exports.knownOperators = read("add/operator");
exports.knownPrototypeMethods = { pipe: true, toPromise: true };
exports.knownStaticMethods = { create: true };
